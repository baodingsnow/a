# 什么是消息队列

消息队列就是我们常说的MQ，英文叫Message Queue，是作为一个单独的中间件产品存在的，独立部署。

消息是在两台计算机间传送的数据单位。消息可以非常简单，例如只包含文本字符串；也可以更复杂，可能包含嵌入对象。

消息被发送到队列中。消息队列(Message Queue, MQ)是在消息的传输过程中保存消息的容器。

消息队列是一种异步的服务间通信方式，使用无服务和微服务架构。

















系统a—写消息—>MQ—读消息—系统B

## 为什么使用消息队列

### 解耦

解耦都不陌生吧，就是降低耦合度，我们都知道Spring的主要目的是降低耦合，那MQ又是如何解耦的呢？如下图所示，系统A是一个关键性的系统，产生数据后需要通知到系统B和系统C做响应的反应，三个系统都写好了，稳定运行；某一天，系统D也需要在系统A产生数据后作出反应，那就得系统A改代码，去调系统D的接口，好，改完了，上线了。假设过了某段时间，系统C因为某些原因，不需要作出反应了，不要系统A调它接口了，就让系统A把调接口的代码删了，系统A的负责人可定会很烦，改来改去，不停的改，不同的测，还得看会不会影响系统B，系统D。没办法，这种架构下，就是这样麻烦。

![](E:\javaNote\JAVA\picture\v2-8692d66368d1b3030c566b4e09c77e97_r.jpg)

那如果使用MQ会是什么样的效果呢？如下图所示，系统A产生数据之后，将该数据写到MQ中，系统A就不管了，不用关心谁消费，谁不消费，即使是再来一个系统E，或者是系统D不需要数据了，系统A也不需要做任何改变，而系统B、C、D是否消费成功，也不用系统A去关心，通过这样一种机制，系统A和其他各系统之间的强耦合是不是一下子就解除了，系统A是不是一下子清爽了很多？

![](E:\javaNote\JAVA\picture\v2-8692d66368d1b3030c566b4e09c77e97_r.jpg)

### 异步

系统A把数据写到MQ里，系统B、C、D就自己去拿，慢慢消费就行了。一般就是一些时效性要求不高的操作，比如下单成功系统A调系统B发下单成功的短信，短信晚几秒发都是OK的。

### 削峰